{% extends "base.html" %}

{% block title %}{{ title }} - Ferramentas Admin{% endblock %}

{% block head_links %}
{{ super() }}
<style>
    /* CSS do seu arquivo Justificativa Ifractal.html */
    /* Idealmente, mova isso para um arquivo .css em static/ e linke aqui, 
       ou integre com seu style.css principal se os estilos forem reutilizáveis. */
    .justificativa-container { max-width: 800px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .justificativa-container label { display: block; margin-top: 15px; font-weight: bold; }
    .justificativa-container input[type="text"],
    .justificativa-container input[type="date"],
    .justificativa-container input[type="number"],
    .justificativa-container select, 
    .justificativa-container textarea { width: 100%; padding: 8px; margin-top: 5px; border-radius: 4px; border: 1px solid #ccc; box-sizing: border-box; }
    
    /* Estilo específico para o botão principal desta ferramenta */
    #btnGerarJustificativa { 
        margin-top: 20px; 
        padding: 10px 20px; 
        background-color: #0d6efd; /* Cor primária do Bootstrap */
        color: white; 
        border: none; 
        border-radius: 4px; 
        cursor: pointer; 
        font-size: 1.1rem;
    }
    #btnGerarJustificativa:hover { 
        background-color: #0b5ed7; 
    }
    .justificativa-resultado { 
        margin-top: 20px; 
        background: #f8f9fa; /* Um cinza um pouco mais claro */
        padding: 15px; 
        border-left: 5px solid #198754; /* Verde para sucesso/resultado */ 
        white-space: pre-wrap; 
        font-family: monospace; 
        border-radius: 4px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="page-header mb-4">
        <h2 class="text-center">{{ title }}</h2>
        <p class="lead text-center">Selecione o tipo de justificativa e preencha os campos para gerar o texto com IA.</p>
    </div>
    <hr>

    <div class="justificativa-container">
        <div class="mb-3">
            <label for="tipo_justificativa" class="form-label">Selecione o Tipo de Justificativa:</label>
            <select id="tipo_justificativa" class="form-select form-select-lg"> {# Adicionado form-select-lg para destaque #}
                <option value="">-- Selecione uma opção --</option>
                <option value="atestado">Atestado Médico</option>
                <option value="troca_plantao">Troca de Plantão</option>
                <option value="atraso">Atraso</option>
                {# Adicione outras opções conforme necessário #}
            </select>
        </div>

        <div id="form-fields-justificativa" class="mt-3">
            {# Campos dinâmicos serão inseridos aqui pelo JavaScript #}
        </div>

        <button type="button" id="btnGerarJustificativa" class="btn btn-primary btn-lg w-100 mt-4"> {# Botão com ID e classes Bootstrap #}
            <span id="spinnerGerarJustificativa" class="spinner-border spinner-border-sm" role="status" aria-hidden="true" style="display: none;"></span>
            <i class="bi bi-magic me-2"></i>Enviar para IA e Gerar Texto
        </button>
        
        <div id="statusGeracaoJustificativa" class="mt-3"></div>
        
        <div id="resultado_justificativa_wrapper" style="display: none;"> {# Wrapper para controlar visibilidade de resultado e botão #}
            <h5 class="mt-4">Justificativa Gerada:</h5>
            <div class="justificativa-resultado" id="resultado_justificativa_texto"></div>
            <button type="button" class="btn btn-secondary mt-2" id="copiarJustificativa" data-bs-toggle="tooltip" data-bs-placement="top" title="Copiar para a área de transferência">
                <i class="bi bi-clipboard-check me-1"></i>Copiar Justificativa
            </button>
        </div>
    </div>

    <div class="mt-5 text-center">
        <a href="{{ url_for('admin.admin_tools') }}" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left-circle me-1"></i>Voltar para Ferramentas Admin
        </a>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }} {# Para incluir quaisquer scripts do base.html #}
<script>
    // Passa URLs e tokens do Flask/Jinja2 para o JavaScript externo
    // Estas variáveis estarão disponíveis globalmente para o admin_justificativas.js
    const justificativaApiUrl = "{{ url_for('admin.api_processar_justificativa') }}";
    const csrfToken = "{{ csrf_token() if csrf_token else '' }}"; 
</script>
<script src="{{ url_for('static', filename='js/admin_justificativas.js') }}"></script>
{% endblock %}
